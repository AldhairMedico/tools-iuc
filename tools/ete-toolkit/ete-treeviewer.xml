<tool id="ete-treeviewer" name="ETE tree viewer" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="20.01" license="MIT">
    <description>visualize a phylogenetic tree</description>
    <macros>
        <token name="@TOOL_VERSION@">3.1.3</token>
        <token name="@VERSION_SUFFIX@">0</token>
    </macros>
    <edam_topics>
        <edam_topic>topic_3293</edam_topic> <!-- phylogenetics -->
    </edam_topics>
    <edam_operations>
        <edam_operation>operation_0567</edam_operation> <!-- phylogenetic tree visualisation -->
    </edam_operations>
    <xrefs>
        <xref type="bio.tools">ete</xref>
    </xrefs>
    <requirements>
        <!--<requirement type="package" version="@TOOL_VERSION@">ete3</requirement>-->
        <requirement type="package" version="8.10.1">curl</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
curl http://etetoolkit.org/get_svg/
    -X POST
    --retry 10
#if '$input_alignment'
    -d "\${ncbitaxa} tree=\$(cat $input_tree);fasta=\$(cat $input_alignment)" > tree.svg
#else
    -d "\${ncbitaxa} tree=\$(cat $input_tree)" > tree.svg
#end if

    ]]></command>
    <inputs>
        <param name="input_tree" type="data" format="newick" label="Newick Tree to visualise" />
        <param name="input_alignment" type="data" format="fasta" optional="true" label="Multiple Alignment fasta file" help="If provided, will add alignment visualisation to tree image" />
        <param name="ncbi_taxa" type="boolean" checked="true" truevalue="ncbitaxa=true;" falsevalue="" label="Resolve Taxonomic IDs?" help="Nodes in the tree must be annotated with NCBI TaxIDs" />
    </inputs>
    <outputs>
        <data name="output_file" from_work_dir="tree.svg" format="svg" label="${tool.name} on ${on_string}: Tree SVG"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1"><!-- test 1: with NCBI TaxIDs -->
            <param name="input_tree" value="quicktree_alignment_VARL_NCBI.tre" ftype="newick"/>
            <output name="output_file" file="quicktree_VARL_NCBI.svg" ftype="svg" />
        </test>
        <test expect_num_outputs="1"><!-- test 1: with alignment file -->
            <param name="input_tree" value="example-tree-ncbi.tree" ftype="newick"/>
            <param name="input_alignment" value="example-alignment.fa" ftype="fasta"/>
            <output name="output_file" file="example-treeview.svg" ftype="svg" />
        </test>
    </tests>
    <help><![CDATA[

.. class:: infomark

**What it does**

TODO: Fill in help in reStructuredText format (https://docutils.sourceforge.io/docs/ref/rst/restructuredtext.html)

Usage
.....

usage: ete3 view [-h] [-t [SRC_TREES ...]] [--src_tree_list SRC_TREE_LIST]
                 [--src_tree_attr SRC_TREE_ATTR]
                 [--src_attr_parser SRC_ATTR_PARSER]
                 [--src_tree_format SRC_NEWICK_FORMAT] [-o OUTPUT]
                 [-v {0,1,2,3,4}] [--face FACE] [-m {c,r}] [-i IMAGE] [--text]
                 [--attr SHOW_ATTRIBUTES [SHOW_ATTRIBUTES ...]] [--Iw WIDTH]
                 [--Ih HEIGHT] [--Ir RESOLUTION] [--Iu {px,mm,in}]
                 [-mbs BRANCH_SEPARATION] [--ss] [--sbl] [--ft] [--hln]
                 [--sin] [--tree_width TREE_WIDTH]
                 [--color_by_rank COLOR_BY_RANK [COLOR_BY_RANK ...]] [--raxml]
                 [--alg ALG] [--alg_type {blockseq,compactseq,fullseq}]
                 [--alg_format ALG_FORMAT] [--ncbi] [--heatmap HEATMAP]
                 [--profile PROFILE] [--bubbles BUBBLES]

options:
  -h, --help            show this help message and exit
  --face FACE           adds a face to the selected nodes. In example --face
                        'value:@dist, pos:b-top, color:red, size:10,
                        if:@dist>0.9'

SOURCE TREES:
  -t [SRC_TREES ...]    a list of trees in newick format (filenames or quoted
                        strings)
  --src_tree_list SRC_TREE_LIST
                        path to a file containing many source trees, one per
                        line
  --src_tree_attr SRC_TREE_ATTR
                        attribute in source tree used as leaf name
  --src_attr_parser SRC_ATTR_PARSER
                        Perl regular expression wrapping the portion of the
                        target attribute that should be used.
  --src_tree_format SRC_NEWICK_FORMAT

GENERAL OPTIONS:
  -o OUTPUT             Base output file name
  -v {0,1,2,3,4}        Verbosity level: 0=totally quite, 1=errors only,
                        2=warning+errors, 3=info+warnings+errors 4=debug

TREE IMAGE GENERAL OPTIONS:
  -m {c,r}, --mode {c,r}
                        (r)ectangular or (c)ircular visualization
  -i IMAGE, --image IMAGE
                        Render tree image instead of showing it. A filename
                        should be provided. PDF, SVG and PNG file extensions
                        are supported (i.e. -i tree.svg)
  --text                Shows the tree using ASCII characters
  --attr SHOW_ATTRIBUTES [SHOW_ATTRIBUTES ...], --show_attributes SHOW_ATTRIBUTES [SHOW_ATTRIBUTES ...]
                        Display the value of the specified attributes, if
                        available
  --Iw WIDTH, --width WIDTH
                        width of the rendered image in pixels (see --size-
                        units).
  --Ih HEIGHT, --height HEIGHT
                        height of the rendered image in pixels (see --size-
                        units).
  --Ir RESOLUTION, --resolution RESOLUTION
                        Resolution if the tree image (DPI)
  --Iu {px,mm,in}, --size_units {px,mm,in}
                        Units used to specify the size of the image.
                        (px:pixels, mm:millimeters, in:inches).
  -mbs BRANCH_SEPARATION, --min_branch_separation BRANCH_SEPARATION
                        Min number of pixels to separate branches vertically.
  --ss, --show_support  Shows branch bootstrap/support values
  --sbl, --show_branch_length
                        Show branch lengths.
  --ft, --force_topology
                        Force branch length to have a minimum length in the
                        image
  --hln, --hide_leaf_names
                        Hide leaf names.
  --sin, --show_internal_names
                        Show the name attribute of all internal nodes.
  --tree_width TREE_WIDTH
                        Adjust tree scale so the distance from root to the
                        farthest leaf uses a fixed width in pixels.

TREE EDIT OPTIONS:
  --color_by_rank COLOR_BY_RANK [COLOR_BY_RANK ...]
                        If the attribute rank is present in nodes
  --raxml               Parses the newick string and extracts bootstrap values
                        from a non-standard RAxML newick file (i.e
                        '((A,B)[100]);'

PHYLOGENETIC OPTIONS:
  --alg ALG             Link tree to a multiple sequence alignment.
  --alg_type {blockseq,compactseq,fullseq}
                        How sequence alignment should be drawn in the tree
  --alg_format ALG_FORMAT
                        fasta, phylip, iphylip, relaxed_iphylip,
                        relaxed_phylip.
  --ncbi                If enabled, default style will be applied to show ncbi
                        taxonomy annotations
  --heatmap HEATMAP     attr_name v1, v2, v3, v4
  --profile PROFILE     attr_name v1, v2, v3, v4
  --bubbles BUBBLES






**Input**


**Output**


    ]]></help>
    <citations>
        <citation type="doi">10.1093/molbev/msw046</citation>
    </citations>
</tool>
