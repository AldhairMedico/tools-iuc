<tool id="quicktree" name="Quicktree" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="20.01" license="MIT">
    <description></description>
    <macros>
        <token name="@TOOL_VERSION@">2.5</token>
        <token name="@VERSION_SUFFIX@">0</token>
    </macros>
    <edam_topics>
        <edam_topic>topic_3293</edam_topic> <!-- phylogenetics -->
    </edam_topics>
    <edam_operations>
        <edam_operation>operation_0540</edam_operation> <!-- Phylogenetic inference (from molecular sequences) -->
    </edam_operations>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">quicktree</requirement>
        <requirement type="package" version="3.4">hmmer</requirement> <!-- for file conversion with esl-reformat-->
    </requirements>
    <version_command>quicktree -v</version_command>
    <command detect_errors="exit_code"><![CDATA[

#if $input_alignment.metadata.ftype == "stockholm"
    ln -s '$input_alignment' input.stockholm
#else
    esl-reformat --informat a2m -o input.stockholm stockholm '$input_alignment'
#end if
&&
quicktree
-in a
-out t
input.stockholm
> '$output_tree'

    ]]></command>
    <inputs>
        <param argument="input_alignment" type="data" format="fasta,stockholm,clustal,pfam_profile,phylip" label="Alignment file" />
    </inputs>
    <outputs>
        <data name="output_tree" format="newick" from_work_dir="output.stockholm" label="${tool.name} on ${on_string}: stockholm format"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1"><!-- test basic case -->
            <param name="input_alignment" value="example.009.AA.fasta" ftype="stockholm"/>
            <output name="output_tree" file="example.009.AA.newick" ftype="newick"/>
        </test>
    </tests>
    <help><![CDATA[

.. class:: infomark

**What it does**

TODO: Fill in help in reStructuredText format (https://docutils.sourceforge.io/docs/ref/rst/restructuredtext.html)

Usage
.....

Usage: quicktree [-options] <inputfile>
Options:
-in <m|a>        : input file is a distance matrix in phylip format (m)
                   or an alignment in stockholm format* (a, default)
-out <m|t>       : output is a distance matrix in phylip format (m) or
                   a tree in New Hampshire format

Advanced options :
-upgma           : Use the UPGMA method to construct the tree
                     (ignored for distance matrix outputs)
-kimura          : Use the kimura translation for pairwise distances
                     (ignored for distance matrix inputs)
-boot <n>        : Calcuate bootstrap values with n iterations
                     (ignored for distance matrix outputs)
-v               : print version and exit



**Input**


**Output**


    ]]></help>
    <citations>
        <citation type="doi">10.1093/oxfordjournals.molbev.a040454</citation>
    </citations>
</tool>
