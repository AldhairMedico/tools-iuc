<tool id="seurat_plot" name="Plot seurat data" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <expand macro="version_command"/>
    <command detect_errors="exit_code"><![CDATA[
@CMD@
    ]]></command>
    <configfiles>
        <configfile name="script_file"><![CDATA[
@CMD_imports@
@CMD_read_inputs@

#if $method.method == 'VlnPlot'
seurat_obj<-VlnPlot(
    seurat_obj,
    #set $features = (x.strip() for x in str($method.features).split(','))
    features = c($features),
    #if $method.idents != ''
    idents = '$method.idents',
    #end if
    sort = $method.sort,
    #if $method.assay != ''
    assay = '$method.assay',
    #end if
    #if $method.layer != ''
    layer = '$method.layer'
    #end if
)

#else if $method.method == 'FeatureScatter'
seurat_obj<-FeatureScatter(
    seurat_obj,
    feature1 = '$method.feature1',
    feature2 = '$method.feature2'
)

#else if $method.method == 'VariableFeaturePlot'
plot<-VariableFeaturePlot(
    seurat_obj,
)
    #if $method.label_points.label_points == 'true'
    plot<-LabelPoints(
        plot = plot,
        points = '$method.label_points.points',
        repel = $method.label_points.repel
    )

#else if $method.method == 'VizDimLoadings'
seurat_obj<-VizDimLoadings(
    seurat_obj,
)

#else if $method.method == 'DimPlot'
seurat_obj<-DimPlot(
    seurat_obj,
)

#else if $method.method == 'DimHeatmap'
seurat_obj<-DimHeatmap(
    seurat_obj,
)

#else if $method.method == 'ElbowPlot'
seurat_obj<-ElbowPlot(
    seurat_obj,
)

#else if $method.method == 'FeaturePlot'
seurat_obj<-FeaturePlot(
    seurat_obj,
)

#else if $method.method == 'DoHeatmap'
seurat_obj<-DoHeatmap(
    seurat_obj,
)

#end if

@CMD_rds_write_outputs@

]]></configfile>
    </configfiles>
    <inputs>
        <expand macro="input_rds"/>
        <conditional name="method">
            <param name="method" type="select" label="Method used">
                <option value="VlnPlot">Violin Plot with 'VlnPlot'</option>
                <option value="FeatureScatter">Scatter Plot with 'FeatureScatter'/>
                <option value="VariableFeaturePlot">Plot Variable Genes with 'VariableFeaturePlot'/>
                <option value="VizDimLoadings">Visualise PCA Results with 'VizDimLoadings'/>
                <option value="DimPlot">Visualise Dimensional Reduction with 'DimPlot'/>
                <option value="DimHeatmap">Visualise PCA Results with 'DimHeatmap'/>
                <option value="ElbowPlot">Determine dimensionality with 'ElbowPlot'/>
                <option value="FeaturePlot">Visualise expression with 'FeaturePlot'/>
                <option value="DoHeatmap">Visualise expression with 'DoHeatmap'/>
            </param>
            <when value="VlnPlot">
                <param name="features" type="text" value="" label="Features to plot"/>
                <param name="idents" type="text" optional="true" value="" label="Classes to include in plot"/>
                <param name="sort" type="boolean" truevalue="TRUE" falsevalue="FALSE" checked="false" label="Sort identity classes by average expression"/>
                <param name="assay" type="text" optional="true" value="" label="Assay to use"/>
                <param name="layer" type="text" optional="true" value="" label="Layer to use"/>
            </when>
            <when value="FeatureScatter">
                <param name="feature1" type="text" value="" label="First feature to plot"/>
                <param name="feature2" type="text" value="" label="Second feature to plot"/>
            </when>
            <when value="VariableFeaturePlot">
                <conditional name="label_points"/>
                    <param name="label_points" type="select" label="Label points on plot">
                        <option value="TRUE">Yes</option>
                        <option value="FALSE" selected="true">No</option>
                    </param>
                    <when value="TRUE">
                        <param name="points" type="text" value="top10"/>
                        <param name="repel" type="boolean" truevalue="TRUE" falsevalue="FALSE" checked="true" label=""/>
                    </when>
                    <when value="FALSE"></when>
                </conditional>
            </when>
            <when value="VizDimLoadings">
                <param name="" label=""/>
            </when>
            <when value="DimPlot">
                <param name="" label=""/>
            </when>
            <when value="DimHeatmap">
                <param name="" label=""/>
            </when>
            <when value="ElbowPlot">
                <param name="" label=""/>
            </when>
            <when value="FeaturePlot">
                <param name="" label=""/>
            </when>
            <when value="DoHeatmap">
                <param name="" label=""/>
            </when>
        </conditional>
        <expand macro="inputs_common_advanced"/>
    </inputs>
    <outputs>
        <expand macro="seurat_outputs"/>
    </outputs>
    <tests>

    </tests>
    <help><![CDATA[
Seurat
======

Seurat is an R package designed for QC, analysis, and exploration of single-cell RNA-seq data. 

Seurat aims to enable users to identify and interpret sources of heterogeneity from single-cell transcriptomic measurements, and to integrate diverse types of single-cell data.

VlnPlot
=======

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/vlnplot>`__


FeatureScatter
==============

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/featurescatter>`__

VariableFeaturePlot
===================

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/variablefeatureplot>`__

VizDimLoadings
==============

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/vizdimloadings>`__

DimPlot
=======

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/dimplot>`__

DimHeatmap
==========

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/dimheatmap>`__

ElbowPlot
=========

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/elbowplot>`__

FeaturePlot
===========

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/featureplot>`__

DoHeatmap
=========

More details on the `seurat documentation
<https://satijalab.org/seurat/reference/doheatmap>`__


    ]]></help>
    <expand macro="citations"/>
</tool>